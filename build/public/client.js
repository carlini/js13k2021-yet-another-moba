var Kt,Nt,kt,Ft,Zt,$t,Jt,It,Ut,qt,Dt,Gt={},Lt=(Mt=0,0),Rt=0,Vt={},Bt={};function Et(){pt=new AudioContext,arr=[3,,.05,.75,.15,.3,,,,1,,,,,,,-1,1,.1,-.55,1,,,.5,1,.75,.95,,1,.35,.05,-.2,-.1,.55,.9,.6,.9,1,-.85,1,.55,.2,.1,-.15,.35,,,.2,0,.05,.2,.2,.05,.05,,,,,,-.65,,,,,,,.1,-.8,,.05,,.3,1,.1,.2,,.3,.5,.1,-.05,-.05,.85,,,-1,,,,-.1,.7,.1,-.05,.2,,-1,.2,1,.15,.35,,.55,.2,,-.15,-.05,1,,,,.2,-.5,.95,-.7,-.1,.15,-.05,,,,.15,1,.5,.7,,1,.2,,-.15,-.05,1,,,,.2,-.5,.95,-.7,-.1,.15,-.05,,,,.2,3,,.05,.75,.4,.4,,,,1,,.5,.6,,,,1,,.05,-.25,1,,,.3,3,.7,.1,,.05,.1,,.1,,.45,,,,.1,-.15,,-.65,,.15,-.15,.45,,,.2,0,.8,,,.3,.3,.05,,-.1,.6,.05,,,,,,.65,.35,.1,-.05,,,,.3],arr=e(arr.map(t=>t||0),24),(wt={}).ti=gt(arr[3]),wt.Et=gt(arr[1]),wt.ci=gt(arr[4]),wt.Wt=gt(arr[5]),wt.Tt=gt(arr[7]),wt.ui=gt(arr[2]),wt.si=gt(arr[8]),arr[3][2]=.6,wt.ii=gt(arr[3]),wt[0]=wt._i=gt(arr[6]),wt[1]=wt.li=gt(arr[0]),function(){var t="#version 300 es\n precision mediump float;in vec4 s,e,t,l;uniform int f;uniform vec4 c,a;uniform float B,w,o;out vec4 n;float x(vec2 G){return fract(sin(dot(G.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec3 q=normalize(s.xyz);float p;vec2 g=2.*gl_PointCoord.xy-vec2(1,1);if(f==1){p+=pow(clamp(dot(vec3(0,0,-1),q),0.,1.),3.);p+=pow(clamp(dot(vec3(1,0,.5),q),0.,1.),3.);p+=pow(clamp(dot(vec3(-.5,-.86,.5),q),0.,1.),3.);p+=pow(clamp(dot(vec3(-.5,.86,.5),q),0.,1.),3.);p/=2.;p+=.2+w;n+=(t)*vec4(p,p,p,1);}if(f==2){n.rgb=s.rgb;n.w=smoothstep(1.,0.,length(g))*t.x;}if(f==5){n.xyz=vec3(1.);n.w=abs((s.x-B+200.)/250.-length(l.xy))<.1?1.:0.;}if(f==4){vec2 v=clamp(mod(l.xy/15.,1.),0.,1.);float D=smoothstep(1.,0.,abs(v.x-.99)*100.)+smoothstep(1.,0.,abs(v.y-.99)*100.);n=vec4(0,min(D,1.),0,1);float F,Z=F=0.;for(float j=0.;j<3.;j++){vec3 p=e.xyz/40.-vec3(1,1,0)+a.xyz/(130.+j*60.)+j*20.;p=mod(p,2.);p=abs(p-1.);for(int i=0;i<15;i+=1){p=abs(p)/dot(p,p)-.48-j/50.;Z+=abs(length(p)-F);F=length(p);}}Z*=Z*Z;n.rgb+=.5*clamp(pow(vec3(Z/3e6,Z/2e6,Z/2e6),vec3(.9)),0.,2.);n.w=1.;}if(f==3){bool y=abs(gl_PointCoord.x-.5)>.48||abs(gl_PointCoord.y-.5)>.08;vec3 c=y?vec3(0):(t.y>gl_PointCoord.x?(t.x>.5?vec3(.2,.2,.8):vec3(.8,.2,.2)):t.z>gl_PointCoord.x?vec3(.9,.3,.9):vec3(.2,.2,.2));n=vec4(c,abs(gl_PointCoord.y-.5)<.1);}if(f==10){vec2 z=gl_PointCoord.xy-vec2(.5,.5);bool y=abs(z.x)>.48||abs(z.y)>.48;vec3 c=y?vec3(0):(s.x>=1.)?vec3(0,.4,.9):(1.-s.x)*6.28-3.14<atan(z.x,z.y)?vec3(0,.2,.5):vec3(.2,.2,.2);n=vec4(c,1);return;}if(f==7){n.xyzw=t.rggb;}if(o>.5){n.xyz=vec3(length(n.xyz))/2.;}float E=smoothstep(1.,0.,(length(e.xy)-55.)/10.);n.xyz*=vec3(E);}",i=Ot.createProgram(),s=`#version 300 es\n precision mediump float;precision mediump int;in vec4 k,r,u,m,h;uniform int f;uniform float B;out vec4 s,e,t,l;uniform vec4 c,a;uniform mat4 b,d;void main(){vec4 A=k+vec4((B-h.x)/16.*m.xyz,0);e=(A)*b-c;s=r*b;t=u;mat4 C=inverse(d);if(f==3){gl_PointSize=r.z;e.z+=r.y;gl_Position.x-=e.w*1.25;}gl_Position+=C*e;if(f==2){t.x*=smoothstep(1.,0.,(B-h.x)/(h.y-h.x));gl_PointSize=(4000./gl_Position.w)*(2.+t.x)*u.y/float(${1<<(ui>>1)});s=r;}if(f==10){gl_Position=k;gl_PointSize=100.;}l=k;}`;[[Ot.VERTEX_SHADER,s],[Ot.FRAGMENT_SHADER,t]].map(t=>{var s=Ot.createShader(t[0]);Ot.shaderSource(s,t[1]),Ot.compileShader(s),Ot.attachShader(i,s)}),Ot.linkProgram(i),It={};var h=1;(t+s).match(/[a-zA-Z_]+(\[[0-9]*\])?/g).map(t=>{var s=[t];t.indexOf`[`>0&&(s=n(32).map(i=>t.replace(/[0-9]+/,i))),"in"==t&&(h=1),"uniform"==t&&(h=0),s.map(t=>It[t]=It[t]||(h?Ot.getAttribLocation(i,t):Ot.getUniformLocation(i,t)))}),Ot.useProgram(i)}(),window.onkeydown=(t=>void 0===Vt[t.key]&&(Vt[t.key]=1)),window.onkeyup=(t=>delete Vt[t.key]),ii=document.body.offsetWidth,si=document.body.offsetHeight,cQ.onmousemove=(t=>{ti=t.clientY,Yt=t.clientX}),cQ.onmousedown=(t=>Vt.vi=1),Ht(1),gQ.style.display="block",zt=-2,qQ.style.display="none",setTimeout(t=>li(1),0),cU0.onclick=(t=>Wt(0)),cU1.onclick=(t=>Wt(1)),cU2.onclick=(t=>Wt(2)),rQ0.onmouseover=(t=>ei("",0,4e3)),rQ1.onmouseover=(t=>ei("",1,4e3)),rQ2.onmouseover=(t=>ei("",2,4e3)),rQ3.onmouseover=(t=>ei("",3,4e3)),window.oncontextmenu=(t=>t.preventDefault())}function Wt(t){St.map(t=>t.ot=1),Dt=t,yt(wt.Wt,1),function(){qt=io({upgrade:0,transports:["websocket"]}),setInterval(t=>{qt.emit(13,l())},1e3),qt.on(7,(t,i)=>{var s=(t+l())/2;_+=i-s}),qt.on(6,dt),qt.on(17,t=>yt(wt[t],.7)),qt.on(12,t=>{ni("Game starting in "+(1+(0|t/1e3))+" seconds",1e3)}),qt.on(11,t=>{Ht(0),ft(),qt.emit(1,Dt,0),Xt(t),Xt(t),zt=0}),qt.on(19,t=>{Xt([t],1),qt.emit(15,b(U[oi.gt],c(2.3)))}),qt.on(2,Xt);var t=t=>{alert`Lost connection;reloading.`,document.location=""};qt.on(8,t=>{ni(t==oi.gt?"Victory!":"Defeat.:(",3e3),zt=1,Ut=t}),qt.on("connect_failed",t),qt.on("connect_error",t),qt.on(16,t),window.onresize=t}(),gQ.style.display="none"}function Xt(t,i){St.map(t=>Gt[t.uid]=t),t.map(t=>{var s=Gt[t.uid];if(s)Object.keys(t).map(i=>{var h=z(t[i]);s==oi&&h&&h.D==y.name&&!h.L||(s[i]=h)});else{var h=z(t);h.setup&&h.setup(),St.push(h),i&&(Rt=(oi=h).At,$t[$t.length-1].z+=1)}})}var Yt,ti,ii,si,hi=null;function ni(t,i){hi&&clearTimeout(hi),gQ.style.display="block",gQ.innerText=t,hi=setTimeout(t=>gQ.style.display="none",i)}function ei(t,i,s){wQ.style.display="block",wQ.innerText=t+" "+ht[i]+" Press "+(1+i)+" to use",setTimeout(t=>wQ.style.display="none",s)}function Ht(t){Nt=k(),kt=Q,St=[],Kt=[],Gt={},is_dead=null,$t=[],ri=[0,0,0],ai=new O(H(N[2],s(1e3,1e3,1)),s(0,0,-1),0,[1,1,1],4);var i,h=n(90).map(t=>o(32).H()).flat();glitter=new O([h,Array(90).fill([.3,.4,.4]).flat()],Q,p,[.5,.05,.5],2),glitter.ht=Ot.POINTS,n(90).map(t=>glitter.h[3*t+1]=1e6),glitter.et(),n(3*t).map(t=>{var i=new E(0,t);i.R=s(15-15*t,3,0),i.setup(),St.push(oi=i),i.pt=(t=>i.tt=c(l()/2e3))}),$t=[(i=new O(H(N[2],10),Q,0,[.1,0,0],7),i.pt=(t=>{i.R=kt,i.it=new Float32Array(Array(144).fill(ri).flat()),i.et()}),i)],Ft=m(-.9)}var ri,oi,ai,ci,ui=1,_i=0;function li(h){requestAnimationFrame(li),1;var n=h-Mt;_i+=n;var e=Yt/ii-.5,o=.5-ti/si;St.map(t=>t.pt&&t.pt(n)),Kt.map(t=>t.pt(n)),$t.map(t=>t.pt&&t.pt(n));var u=s(4*(2*oi.gt-1),16*(1-2*oi.gt),20);if(0==zt){if(ci!=(0|oi.Pt)&&(ei((ci=0|oi.Pt)<4?"New Ability:":"Upgraded Ability:",ci%4,1e4),qt.emit(5,oi.uid,10),Bt[ci+1]&&(Bt[ci+1].q.X[0]=2)),oi.At<Rt){var _=(Rt-oi.At)/oi.Qt*80;Lt+=_**.5/400,yt(wt.ci,_/10),Rt=oi.At}if(oi.At<=0){if(camera_target=a(St,t=>(2*oi.gt-1)*(t.R.x+t.R.y)+1e6*(t.gt==oi.gt)-1e6*(t instanceof X)).R,!oi.di){setTimeout(t=>{qt.emit(1,Dt,1)},1e4),oi.di=1;var v=10+(ci>>2);ut(t=>ni("Respawning in "+(v-t),1e3),v,1e3)}}else{0;for(var d=i(Zt||p,s(2e5*e,2e5*o,1e5,1e5)).C(kt),f=kt.A(i(Ft,s(0,1,0)));f.z>0;)f=f.F(d,.1);for(var x in f.z=0,Jt=f,Bt)Vt[x]&&(Bt[x].Yt(f)?Bt[x].act(f):(!wt.ui.fi||wt.ui.fi<Mt)&&(wt.ui.fi=Mt+300,yt(wt.ui),setTimeout(t=>yt(wt.ui,1),100)),Vt[x]=0);Vt.vi&&null!=oi.ht&&(oi.Ct()||(f=Q.F(f,62),oi.Jt=y(oi.R,oi.tt,f,8+2*oi.ht,l()),Kt.push(new rt(f)),qt.emit(15,oi.Jt)),delete Vt.vi),camera_target=oi.R}kt=kt.C(camera_target.C(u).A(kt).S(.05))}else 1==zt?kt=kt.F(U[1-Ut].F(Q,5).C(u),1):-2==zt&&(kt=s(0,22,22));Ft=[c((1-oi.gt)*Math.PI),m(-.9),c(r()*Lt),m(r()*Lt),w(r()*Lt)].reduce(t),ri=[1,0,(Lt*=.92)**.7*3],St.map(t=>t.ot&&t.Ht&&!zt&&t.Ht()),St=St.filter(t=>!t.ot),$t=$t.filter(t=>!t.ot),Kt=Kt.filter(t=>!t.ot),Nt(),Mt=h}function vi(){var t;console.log("Please don't cheat."),Ot=cQ.getContext`webgl2`,t=2,cQ.height=(cQ.width=3200>>(0|(ui=d(t,0,6))/2))/window.innerWidth*window.innerHeight,Et()}window.onload=(t=>fetch`z`.then(t=>t.arrayBuffer().then(t=>(function(t){for(S(),t=t.split``;t.length>8;)N.push(P(t));setTimeout(vi,1)})(Array.from(new Uint8Array(t)).map(t=>t.toString(2).padStart(8,0)).join``))))